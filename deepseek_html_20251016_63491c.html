<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Application de Suivi des CongÃ©s - Centre IntermÃ©diaire Ali Trad</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <header>
        <div class="container">
            <h1>ğŸ¥ Application de Suivi des CongÃ©s - Centre IntermÃ©diaire Ali Trad</h1>
        </div>
    </header>
    <div class="container">
        <!-- Ã‰cran de sÃ©paration RH/EmployÃ©s -->
        <div id="login-selection" class="login-section">
            <h2>ğŸ” Connexion au SystÃ¨me</h2>
            <p style="text-align: center; margin-bottom: 2rem; color: #7f8c8d;">
                Veuillez choisir votre type de connexion
            </p>
            
            <div class="login-options">
                <div class="login-option" onclick="showLoginForm('rh')">
                    <h3>ğŸ‘¨â€ğŸ’¼ Espace Responsable RH</h3>
                    <p>AccÃ¨s Ã  la gestion complÃ¨te des congÃ©s, du personnel et des rapports</p>
                    <button style="background: #3498db;">Se connecter en tant que RH</button>
                </div>
                
                <div class="login-option" onclick="showLoginForm('employee')">
                    <h3>ğŸ‘¤ Espace EmployÃ©</h3>
                    <p>Gestion de vos demandes de congÃ© et consultation de vos soldes</p>
                    <button style="background: #2ecc71;">Se connecter en tant qu'employÃ©</button>
                </div>
            </div>
        </div>

        <!-- Section de connexion principale (cachÃ©e par dÃ©faut) -->
        <div id="main-login" class="login-section" style="display: none;">
            <h2 id="login-title">ğŸ” Connexion</h2>
            <div style="text-align: center; margin-bottom: 1.5rem;">
                <button class="user-type-btn active" onclick="showLoginForm('rh')">ğŸ‘¨â€ğŸ’¼ RH</button>
                <button class="user-type-btn" onclick="showLoginForm('employee')">ğŸ‘¤ EmployÃ©</button>
            </div>
            
            <!-- Formulaire de connexion RH -->
            <div id="rh-login-form">
                <h3>Connexion Responsable RH</h3>
                <form id="rh-login">
                    <div class="form-group">
                        <label for="rh-username">Nom d'utilisateur</label>
                        <input type="text" id="rh-username" required value="admin">
                    </div>
                    <div class="form-group password-toggle">
                        <label for="rh-password">Mot de passe</label>
                        <input type="password" id="rh-password" required value="admin123">
                        <span class="toggle-icon" onclick="togglePassword('rh-password')">ğŸ‘ï¸</span>
                    </div>
                    <button type="submit" style="width: 100%;">Se connecter</button>
                </form>
            </div>
            
            <!-- Formulaire de connexion EmployÃ© -->
            <div id="employee-login-form" style="display: none;">
                <h3>Connexion EmployÃ©</h3>
                <form id="employee-login">
                    <div class="form-group">
                        <label for="employee-select">SÃ©lectionnez votre compte</label>
                        <select id="employee-select" required>
                            <option value="">Choisissez votre nom</option>
                        </select>
                    </div>
                    <div class="form-group password-toggle">
                        <label for="employee-password">Mot de passe personnel</label>
                        <input type="password" id="employee-password" required value="1234">
                        <span class="toggle-icon" onclick="togglePassword('employee-password')">ğŸ‘ï¸</span>
                    </div>
                    <button type="submit" style="width: 100%;">Se connecter</button>
                </form>
            </div>
            
            <div style="text-align: center; margin-top: 1rem;">
                <button onclick="showLoginSelection()" style="background: #6c757d;">â† Retour au choix de connexion</button>
            </div>
            
            <div id="login-alert" class="alert alert-danger" style="display: none; margin-top: 1rem;"></div>
        </div>

        <!-- Interface RH -->
        <div id="rh-interface" style="display: none;">
            <div style="background: #e8f5e8; padding: 1rem; border-radius: 8px; margin-bottom: 1rem; display: flex; justify-content: space-between; align-items: center;">
                <div>
                    <strong>ğŸ‘¨â€ğŸ’¼ ConnectÃ© en tant que :</strong> 
                    <span id="connected-rh-name">Administrateur RH</span>
                </div>
                <button onclick="logout()" style="background: #6c757d; padding: 0.5rem 1rem;">ğŸšª Se dÃ©connecter</button>
            </div>
            
            <div class="nav-tabs">
                <button class="nav-tab active" onclick="switchTab('dashboard')">ğŸ“Š Tableau de Bord</button>
                <button class="nav-tab" onclick="switchTab('gestion')">âš™ï¸ Gestion des CongÃ©s</button>
                <button class="nav-tab" onclick="switchTab('personnel')">ğŸ‘¥ Gestion du Personnel</button>
                <button class="nav-tab" onclick="switchTab('soldes')">ğŸ’° Soldes des CongÃ©s</button>
                <button class="nav-tab" onclick="switchTab('rapports')">ğŸ“‹ Rapports & Impression</button>
                <button class="nav-tab" onclick="switchTab('securite')">ğŸ” SÃ©curitÃ©</button>
            </div>
            
            <div id="dashboard" class="tab-content active">
                <h2>ğŸ“Š Tableau de Bord</h2>
                <div class="stats-grid">
                    <div class="stat-card"><div class="stat-number" id="total-employees">0</div><div>EmployÃ©s</div></div>
                    <div class="stat-card"><div class="stat-number" id="pending-requests">0</div><div>Demandes en attente</div></div>
                    <div class="stat-card"><div class="stat-number" id="approved-requests">0</div><div>CongÃ©s approuvÃ©s</div></div>
                    <div class="stat-card"><div class="stat-number" id="rejected-requests">0</div><div>CongÃ©s rejetÃ©s</div></div>
                </div>
            </div>
            
            <div id="gestion" class="tab-content">
                <h2>âš™ï¸ Gestion des CongÃ©s</h2>
                <div class="form-group">
                    <label for="filter-status">ğŸ” Filtrer par statut</label>
                    <select id="filter-status" onchange="filterLeaves()">
                        <option value="all">Tous les statuts</option>
                        <option value="pending">En attente</option>
                        <option value="approved">ApprouvÃ©</option>
                        <option value="rejected">RejetÃ©</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="filter-type">ğŸ” Filtrer par type</label>
                    <select id="filter-type" onchange="filterLeaves()">
                        <option value="all">Tous les types</option>
                        <option value="annuel">CongÃ© annuel</option>
                        <option value="maladie">CongÃ© de maladie</option>
                        <option value="longue-duree">CongÃ© de longue durÃ©e</option>
                        <option value="maternite">CongÃ© de maternitÃ©</option>
                        <option value="recuperation">CongÃ© de rÃ©cupÃ©ration</option>
                        <option value="radio">CongÃ© de radio</option>
                        <option value="certificat">Certificat d'accompagnement</option>
                        <option value="sans-solde">CongÃ© sans solde</option>
                        <option value="exceptionnel">CongÃ© exceptionnel</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="filter-grade">ğŸ” Filtrer par grade</label>
                    <select id="filter-grade" onchange="filterLeaves()">
                        <option value="all">Tous les grades</option>
                    </select>
                </div>
                <div style="overflow-x: auto;">
                    <table id="leaves-table">
                        <thead>
                            <tr>
                                <th>EmployÃ©</th>
                                <th>Grade</th>
                                <th>Type</th>
                                <th>PÃ©riode</th>
                                <th>Jours</th>
                                <th>Adresse & TÃ©lÃ©phone</th>
                                <th>Statut</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="leaves-list">
                            <tr>
                                <td colspan="8" style="text-align: center; padding: 2rem;">Aucune demande de congÃ©</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
            
            <div id="personnel" class="tab-content">
                <h2>ğŸ‘¥ Gestion du Personnel</h2>
                <button onclick="showAddEmployeeForm()" style="margin-bottom: 1rem;">â• Ajouter un employÃ©</button>
                <div style="overflow-x: auto;">
                    <table id="employees-table">
                        <thead>
                            <tr>
                                <th>Nom</th>
                                <th>PrÃ©nom</th>
                                <th>Email</th>
                                <th>Grade</th>
                                <th>Date d'embauche</th>
                                <th>Solde CongÃ©s</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="employees-list"></tbody>
                    </table>
                </div>
            </div>
            
            <div id="soldes" class="tab-content">
                <h2>ğŸ’° Soldes des CongÃ©s</h2>
                <div class="form-group">
                    <label for="filter-solde-grade">ğŸ” Filtrer par grade</label>
                    <select id="filter-solde-grade" onchange="updateLeaveBalances()">
                        <option value="all">Tous les grades</option>
                    </select>
                </div>
                <div id="leave-balances-list">
                    <p>Chargement des soldes...</p>
                </div>
            </div>
            
            <div id="rapports" class="tab-content">
                <h2>ğŸ“‹ Rapports & Impression</h2>
                <div class="print-section">
                    <h3>ğŸ“„ Formulaire Officiel Tunisien</h3>
                    <div class="form-group">
                        <label for="tunisian-leave-select">SÃ©lectionner une demande approuvÃ©e</label>
                        <select id="tunisian-leave-select" onchange="updateTunisianForm()">
                            <option value="">Choisir une demande approuvÃ©e</option>
                        </select>
                    </div>
                    <button class="print-btn" onclick="printTunisianForm()">ğŸ–¨ï¸ Imprimer le formulaire officiel</button>
                    
                    <div id="tunisian-form-container" class="tunisian-form" style="display: none;">
                        <!-- Le contenu sera gÃ©nÃ©rÃ© dynamiquement -->
                    </div>
                </div>
                
                <div class="print-section" style="margin-top: 2rem;">
                    <h3>ğŸ“„ Imprimer la liste des congÃ©s</h3>
                    <div class="print-controls">
                        <div class="form-group" style="flex: 1; min-width: 200px;">
                            <label for="print-start-date">Date de dÃ©but</label>
                            <input type="date" id="print-start-date">
                        </div>
                        <div class="form-group" style="flex: 1; min-width: 200px;">
                            <label for="print-end-date">Date de fin</label>
                            <input type="date" id="print-end-date">
                        </div>
                        <div class="form-group" style="flex: 1; min-width: 200px;">
                            <label for="print-status">Statut</label>
                            <select id="print-status">
                                <option value="all">Tous les statuts</option>
                                <option value="approved">ApprouvÃ©</option>
                                <option value="pending">En attente</option>
                                <option value="rejected">RejetÃ©</option>
                            </select>
                        </div>
                    </div>
                    <button class="print-btn" onclick="generatePrintableReport()">ğŸ–¨ï¸ GÃ©nÃ©rer le rapport</button>
                    <button class="print-btn" onclick="window.print()" id="print-btn" style="display:none;">ğŸ–¨ï¸ Imprimer</button>
                    <div id="print-preview" style="margin-top: 1rem;"></div>
                </div>
            </div>
            
            <div id="securite" class="tab-content">
                <h2>ğŸ” Gestion de la SÃ©curitÃ©</h2>
                <div class="form-group">
                    <h3>Mot de passe RH</h3>
                    <div class="form-group">
                        <label for="new-rh-password">Nouveau mot de passe RH</label>
                        <input type="password" id="new-rh-password">
                    </div>
                    <div class="form-group">
                        <label for="confirm-rh-password">Confirmer le mot de passe</label>
                        <input type="password" id="confirm-rh-password">
                    </div>
                    <button onclick="changeRHPassword()">ğŸ”„ Changer le mot de passe RH</button>
                </div>
                
                <div class="form-group" style="margin-top: 2rem;">
                    <h3>RÃ©initialiser les mots de passe employÃ©s</h3>
                    <div class="form-group">
                        <label for="reset-employee-select">SÃ©lectionner un employÃ©</label>
                        <select id="reset-employee-select">
                            <option value="">Choisir un employÃ©</option>
                        </select>
                    </div>
                    <button onclick="resetEmployeePassword()">ğŸ”„ RÃ©initialiser le mot de passe</button>
                </div>
            </div>
        </div>

        <!-- Interface EmployÃ© -->
        <div id="employee-interface" style="display: none;">
            <div style="background: #e8f5e8; padding: 1rem; border-radius: 8px; margin-bottom: 1rem; display: flex; justify-content: space-between; align-items: center;">
                <div>
                    <strong>ğŸ‘¤ ConnectÃ© en tant que :</strong> 
                    <span id="connected-employee-name">Non connectÃ©</span>
                </div>
                <button onclick="logout()" style="background: #6c757d; padding: 0.5rem 1rem;">ğŸšª Se dÃ©connecter</button>
            </div>
            
            <div class="nav-tabs">
                <button class="nav-tab active" onclick="switchEmployeeTab('mes-demandes')">ğŸ“‹ Mes Demandes</button>
                <button class="nav-tab" onclick="switchEmployeeTab('nouvelle-demande')">ğŸ“ Nouvelle Demande</button>
                <button class="nav-tab" onclick="switchEmployeeTab('mes-infos')">ğŸ‘¤ Mes Informations</button>
                <button class="nav-tab" onclick="switchEmployeeTab('mon-solde')">ğŸ’° Mon Solde</button>
                <button class="nav-tab" onclick="switchEmployeeTab('mon-compte')">ğŸ” Mon Compte</button>
            </div>
            
            <div id="mes-demandes" class="tab-content active">
                <h2>ğŸ“‹ Mes Demandes de CongÃ©</h2>
                <div style="overflow-x: auto;">
                    <table>
                        <thead>
                            <tr>
                                <th>Type</th>
                                <th>PÃ©riode</th>
                                <th>Jours</th>
                                <th>Adresse & TÃ©lÃ©phone</th>
                                <th>Motif (Exceptionnel)</th>
                                <th>Statut</th>
                                <th>Date de demande</th>
                            </tr>
                        </thead>
                        <tbody id="my-leaves-list">
                            <tr>
                                <td colspan="7" style="text-align: center; padding: 2rem;">Aucune demande de congÃ©</td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <!-- Section pour la feuille de congÃ© officielle -->
                <div class="print-section">
                    <h3>ğŸ“„ Formulaire Officiel Tunisien</h3>
                    <div class="form-group">
                        <label for="official-leave-select">SÃ©lectionner une demande approuvÃ©e</label>
                        <select id="official-leave-select" onchange="updateOfficialForm()">
                            <option value="">Choisir une demande approuvÃ©e</option>
                        </select>
                    </div>
                    <button class="print-btn" onclick="printOfficialForm()">ğŸ–¨ï¸ Imprimer le formulaire officiel</button>
                    
                    <div id="official-form-container" class="tunisian-form" style="display: none;">
                        <!-- Le contenu sera gÃ©nÃ©rÃ© dynamiquement -->
                    </div>
                </div>
            </div>
            
            <div id="nouvelle-demande" class="tab-content">
                <h2>ğŸ“ Nouvelle Demande de CongÃ©</h2>
                <div id="leave-balance-warning" style="display: none;"></div>
                <div id="certificat-alert" class="certificat-alert" style="display: none;">
                    <strong>ğŸ“‹ Attention : Certificat mÃ©dical requis</strong>
                    <p>Vous avez dÃ©passÃ© 30 jours de congÃ© maladie cumulÃ©s cette annÃ©e. Un certificat mÃ©dical confidentiel est obligatoire (Ã  fournir sÃ©parÃ©ment).</p>
                </div>
                <div id="sick-leave-warning" class="sick-leave-alert" style="display: none;">
                    <strong>âš ï¸ Alerte : CongÃ©s maladie</strong>
                    <p>Vous avez dÃ©passÃ© 30 jours de congÃ© maladie cette annÃ©e. Veuillez fournir un certificat mÃ©dical.</p>
                </div>
                <form id="employee-leave-request-form">
                    <div class="form-group">
                        <label for="employee-leave-type">ğŸ“‹ Type de congÃ©</label>
                        <select id="employee-leave-type" required onchange="updateLeaveTypeOptions()">
                            <option value="">SÃ©lectionner le type</option>
                            <option value="annuel">CongÃ© annuel</option>
                            <option value="maladie">CongÃ© de maladie</option>
                            <option value="longue-duree">CongÃ© de longue durÃ©e</option>
                            <option value="maternite">CongÃ© de maternitÃ©</option>
                            <option value="recuperation">CongÃ© de rÃ©cupÃ©ration</option>
                            <option value="radio" id="radio-option" style="display: none;">CongÃ© de radio</option>
                            <option value="certificat">Certificat d'accompagnement</option>
                            <option value="sans-solde">CongÃ© sans solde</option>
                            <option value="exceptionnel">CongÃ© exceptionnel</option>
                        </select>
                    </div>
                    
                    <!-- Champ motif pour congÃ© exceptionnel -->
                    <div id="exceptionnel-motif-group" class="form-group" style="display: none;">
                        <label for="exceptionnel-motif">ğŸ“ Motif du congÃ© exceptionnel</label>
                        <textarea id="exceptionnel-motif" placeholder="Veuillez prÃ©ciser le motif de votre congÃ© exceptionnel..." rows="3" required></textarea>
                    </div>
                    
                    <div class="form-group"><label for="employee-start-date">ğŸ“… Date de dÃ©but</label><input type="date" id="employee-start-date" required onchange="calculateDays()"></div>
                    <div class="form-group"><label for="employee-end-date">ğŸ“… Date de fin</label><input type="date" id="employee-end-date" required onchange="calculateDays()"></div>
                    <div class="form-group">
                        <label for="employee-days">ğŸ“… Nombre de jours</label>
                        <input type="number" id="employee-days" readonly style="background: #f8f9fa;">
                    </div>
                    <div class="form-group">
                        <label for="employee-address">ğŸ  Adresse pendant le congÃ©</label>
                        <input type="text" id="employee-address" placeholder="Votre adresse complÃ¨te pendant le congÃ©" required>
                    </div>
                    <div class="form-group">
                        <label for="employee-phone">ğŸ“ TÃ©lÃ©phone joignable</label>
                        <input type="tel" id="employee-phone" placeholder="Votre numÃ©ro de tÃ©lÃ©phone" required>
                    </div>
                    <button type="submit">âœ… Soumettre la demande</button>
                </form>
            </div>
            
            <div id="mes-infos" class="tab-content">
                <h2>ğŸ‘¤ Mes Informations</h2>
                <div id="employee-info" style="background: #f8f9fa; padding: 1rem; border-radius: 8px;">
                    <p><strong>Nom:</strong> <span id="info-name">-</span></p>
                    <p><strong>Email:</strong> <span id="info-email">-</span></p>
                    <p><strong>Grade:</strong> <span id="info-grade">-</span></p>
                    <p><strong>Date d'embauche:</strong> <span id="info-hire-date">-</span></p>
                    <p><strong>Jours de congÃ© annuel cumulÃ©s:</strong> <span id="info-acquired-leave">-</span></p>
                    <p><strong>Jours de congÃ© annuel pris:</strong> <span id="info-taken-leave">-</span></p>
                    <p><strong>Solde congÃ© annuel restant:</strong> <span id="info-remaining-leave">-</span></p>
                    <p><strong>Jours de congÃ© maladie pris cette annÃ©e:</strong> <span id="info-sick-taken">-</span></p>
                    <div id="radio-leave-info" style="display: none;">
                        <p><strong>CongÃ©s radio acquis:</strong> <span id="info-radio-acquired">-</span></p>
                        <p><strong>CongÃ©s radio pris:</strong> <span id="info-radio-taken">-</span></p>
                        <p><strong>Solde congÃ©s radio restant:</strong> <span id="info-radio-remaining">-</span></p>
                    </div>
                </div>
            </div>
            
            <div id="mon-solde" class="tab-content">
                <h2>ğŸ’° Mon Solde de CongÃ©s</h2>
                <div class="balance-grid" id="employee-balance-grid">
                    <div class="balance-item">
                        <div>CongÃ©s Annuels</div>
                        <div class="balance-number balance-positive">0</div>
                        <div style="font-size: 0.8rem;">sur 0 jours</div>
                    </div>
                    <div class="balance-item">
                        <div>CongÃ©s Maladie</div>
                        <div class="balance-number balance-positive">0</div>
                        <div style="font-size: 0.8rem;">sur 0 jours</div>
                    </div>
                </div>
            </div>
            
            <div id="mon-compte" class="tab-content">
                <h2>ğŸ” Mon Compte</h2>
                <div class="form-group">
                    <h3>Changer mon mot de passe</h3>
                    <div class="form-group">
                        <label for="current-password">Mot de passe actuel</label>
                        <input type="password" id="current-password">
                    </div>
                    <div class="form-group">
                        <label for="new-password">Nouveau mot de passe</label>
                        <input type="password" id="new-password">
                    </div>
                    <div class="form-group">
                        <label for="confirm-password">Confirmer le nouveau mot de passe</label>
                        <input type="password" id="confirm-password">
                    </div>
                    <button onclick="changeEmployeePassword()">ğŸ”„ Changer mon mot de passe</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal pour ajouter un employÃ© -->
    <div id="employee-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>ğŸ‘¤ Ajouter un employÃ©</h3>
                <button class="close-btn" onclick="hideAddEmployeeForm()">&times;</button>
            </div>
            <form id="employee-form">
                <div class="form-group"><label for="new-firstname">PrÃ©nom</label><input type="text" id="new-firstname" required></div>
                <div class="form-group"><label for="new-lastname">Nom</label><input type="text" id="new-lastname" required></div>
                <div class="form-group"><label for="new-email">Email</label><input type="email" id="new-email" required></div>
                <div class="form-group"><label for="new-grade">Grade</label><select id="new-grade" required><option value="">SÃ©lectionner un grade</option></select></div>
                <div class="form-group"><label for="new-hire-date">Date d'embauche</label><input type="date" id="new-hire-date" required></div>
                <div class="form-group">
                    <label for="new-address">Adresse</label>
                    <input type="text" id="new-address" placeholder="Adresse complÃ¨te" required>
                </div>
                <div class="form-group">
                    <label for="new-phone">TÃ©lÃ©phone</label>
                    <input type="tel" id="new-phone" placeholder="NumÃ©ro de tÃ©lÃ©phone" required>
                </div>
                <div class="form-group">
                    <label for="new-initial-balance">Solde initial de congÃ©s annuels (jours)</label>
                    <input type="number" id="new-initial-balance" value="30" min="0" max="60" required>
                </div>
                <div style="display: flex; gap: 1rem; margin-top: 1rem;">
                    <button type="submit">âœ… Ajouter</button>
                    <button type="button" onclick="hideAddEmployeeForm()" style="background: #6c757d;">âŒ Annuler</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Modal pour modifier le solde -->
    <div id="balance-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>ğŸ’° Modifier le solde de congÃ©s</h3>
                <button class="close-btn" onclick="hideBalanceModal()">&times;</button>
            </div>
            <div id="balance-modal-content">
                <!-- Le contenu sera gÃ©nÃ©rÃ© dynamiquement -->
            </div>
        </div>
    </div>

    <script src="script.js"></script>
</body>
</html>